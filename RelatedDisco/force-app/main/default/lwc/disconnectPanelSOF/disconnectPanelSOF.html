<!-- sldsValidatorIgnore -->
<!-- sldsValidatorIgnore -->
<template>
    <template if:false={tasksFetchError}>
        <lightning-card title="Disconnection Task List">
            <lightning-spinner
                if:true={isLoading}
                alternative-text="Loading"
                size="large"
            ></lightning-spinner>
            <template if:false={isLoading}>

                <template if:false={isDiscoInProg}>
                    <lightning-card>
                        <lightning-input
                            style="width: 300px;"
                            type="date"
                            label="Enter Customer Requested Disconnect Date"
                            value={selectedDate}
                            onchange={handleDateChange}
                        ></lightning-input>
                    </lightning-card>
                    <lightning-button
                        variant="brand"
                        label="Disconnect"
                        onclick={initiateDisconnect}
                    ></lightning-button>
                </template>

                <template if:true={isDiscoInProg}>
                    <template if:true={isLoading}>
                        <lightning-spinner
                            alternative-text="Loading"
                            size="large"
                        ></lightning-spinner>
                    </template>
                    <template if:false={isLoading}>
                        <lightning-tile title="Customer Selected Disconnect Date">
                            <lightning-formatted-date-time
                                value={selectedDate}
                                year="numeric"
                                month="long"
                                day="2-digit"
                            ></lightning-formatted-date-time>
                        </lightning-tile>
                        <lightning-card>

                            <lightning-datatable
                                key-field="Id"
                                data={taskData}
                                show-row-number-column="true"
                                columns={columns}
                                oncellchange={onCellChange}
                                errors={errors}
                                draft-values={draftValues}
                                onrowaction={handleRowAction}
                                hide-checkbox-column="true"
                            ></lightning-datatable>
                        </lightning-card>
                    </template>
                    <template if:true={hasTasks}>

                        <lightning-button
                            class="slds-var-m-around_x-small"
                            variant="brand"
                            label="Update Tasks"
                            onclick={updateTasks}
                        ></lightning-button>

                        <lightning-button
                            class="slds-var-m-around_x-small"
                            variant="brand"
                            label="Cancel Update"
                            onclick={handleCancel}
                        ></lightning-button>

                    </template>

                </template>

            </template>
        </lightning-card>
    </template>
    <template if:true={tasksFetchError}>
        <div style="text-align: center; padding: 10px;">
            <p>There was an issue retrieving tasks. Wait 5 min refresh if there is still an error file a ticket</p>
        </div>
    </template>
</template>